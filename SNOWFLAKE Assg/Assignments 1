
# ineuron-assgn

USE DATABASE DEMO_DATABASE;
USE SCHEMA HONEY;

----1. create table and load data.
CREATE OR REPLACE table LV_ASSG_SALES_DATA
( order_id string,
 product_id string,
order_date string,
ship_date string,
ship_mode VARCHAR(20),
customer_name VARCHAR(25),
segment CHAR(20),
state string,
country	VARCHAR(50),
market CHAR(10),
region VARCHAR(50),
category VARCHAR(20),
sub_category VARCHAR(20),
product_name STRING,
sales string,
quantity string,
discount string,
profit string,
shipping_cost string,
order_priority VARCHAR(15),
year string);

select * from LV_ASSG_SALES_DATA;
describe table LV_ASSG_SALES_DATA;

--- 2. SET PRIMARY KEY.

alter table LV_ASSG_SALES_DATA
add primary key (order_id);


--- 3. CHECK THE ORDER DATE AND SHIP DATE TYPE AND THINK IN WHICH DATA TYPE YOU HAVE TO CHANGE.

CREATE OR REPLACE TABLE LV_ASSG_SALES_DATA AS
SELECT*,
to_char(date(order_date), 'YYYY-MM-DD') AS order_date2
from LV_ASSG_SALES_DATA;

CREATE OR REPLACE TABLE LV_ASSG_SALES_DATA AS
SELECT*,
to_char(date(ship_date), 'YYYY-MM-DD') AS ship_date2
from LV_ASSG_SALES_DATA;


---4. EXTACT THE LAST NUMBER FROM ORDER_ID AFTER THE - AND CREATE OTHER COLUMN AND UPDATE IT.

CREATE OR REPLACE TABLE LV_ASSG_SALES_DATA AS
SELECT*, 
REGEXP_SUBSTR(order_id,'[[:digit:]]+',1,2) AS order_no_extract
from LV_ASSG_SALES_DATA;

select order_id,order_no_extract from LV_ASSG_SALES_DATA;

---5. FLAG ,IF DISCOUNT IS GREATER THEN 0 THEN  YES ELSE FALSE AND PUT IT IN NEW COLUMN FRO EVERY ORDER ID.

CREATE OR REPLACE TABLE LV_ASSG_SALES_DATA AS
SELECT *,
        CASE
            WHEN DISCOUNT>0 THEN 'YES'
            ELSE 'NO'
            END AS DISCOUNT_FLAG
FROM LV_ASSG_SALES_DATA;

select DISCOUNT_FLAG from LV_ASSG_SALES_DATA;

---6. FIND OUT HOW MUCH DAYS TAKEN FOR EACH ORDER TO PROCESS FOR THE SHIPMENT FOR EVERY ORDER ID.

CREATE OR REPLACE TABLE LV_ASSG_SALES_DATA AS
SELECT*,
DATEDIFF('days',order_date2,ship_date2) as PROCESS_DAYS
FROM LV_ASSG_SALES_DATA;

/*
---7. FLAG THE PROCESS DAY AS BY RATING IF IT TAKES LESS OR EQUAL 3  DAYS MAKE 5,LESS OR EQUAL 
THAN 6 DAYS BUT MORE THAN 3 MAKE 4,LESS THAN 10 BUT MORE THAN 6 MAKE 3,MORE THAN 10 MAKE IT 2 
FOR EVERY ORDER ID.
*/

CREATE OR REPLACE TABLE LV_ASSG_SALES_DATA AS
SELECT*, 
    CASE
       WHEN PROCESS_DAYS <=3 THEN 5
       WHEN PROCESS_DAYS BETWEEN 4 AND 6 THEN 4
       WHEN PROCESS_DAYS BETWEEN 7 AND 10 THEN 3
       ELSE 2
     END AS RATING
FROM LV_ASSG_SALES_DATA;
